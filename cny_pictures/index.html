<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ğŸ§§ CNY Picture Guessing Game</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family: Arial, sans-serif; text-align: center; background: #fff3e0; padding: 20px; }
  h1 { color: #c62828; margin-bottom: 10px; }
  .grid { display: grid; grid-template-columns: repeat(6, 1fr); width: 480px; height: 480px; margin: 20px auto; gap: 3px; }
  .tile { background-size: 480px 480px; background-color: #c62828; cursor: pointer; }
  .hidden { background-image: none !important; }
  .revealed { pointer-events: none; }
  button { padding: 8px 14px; margin: 6px; background: #c62828; color: white; border: none; cursor: pointer; border-radius: 4px; }
  button:hover { opacity: 0.9; }
  button:disabled { opacity: 0.5; cursor: not-allowed; }
  #result { margin-top: 10px; font-weight: bold; color: #c62828; }
  @media (max-width: 600px) { .grid { width: 90vw; height: 90vw; } .tile { background-size: 90vw 90vw; } }
</style>
</head>
<body>

<h1>ğŸ§§ Guess the CNY Picture ğŸ§§</h1>
<p>Click tiles to reveal the picture. ğŸ Last round: find the prizes!</p>

<div class="grid" id="grid"></div>

<div>
  <button id="revealBtn" onclick="revealAll()">Reveal All</button>
</div>

<div>
  <button id="backBtn" onclick="prevImage()">â¬… Back</button>
  <button id="nextBtn" onclick="nextImage()">Next â¡</button>
</div>

<p id="result"></p>

<script>
const pictures = [
  { src: "orange.jpg", name: "ğŸŠ Orange / æ©™å­" },
  { src: "angbao.jpg", name: "ğŸ§§ Ang Bao / çº¢åŒ…" },
  { src: "cny-goodies.jpg", name: "ğŸª CNY Goodies / å¹´é¥¼" },
  { src: "yusheng.jpg", name: "ğŸ¥— Yu Sheng / é±¼ç”Ÿ" },
  { src: "chunlian.jpg", name: "ğŸ§¾ Chun Lian / æ˜¥è”" },
  { src: "traditional-costume.jpg", name: "ğŸ‘˜ Traditional Costume / ä¼ ç»Ÿæœè£…" },
  { src: "reunion-dinner.jpg", name: "ğŸ½ï¸ Reunion Dinner / å›¢åœ†é¥­" },
  { src: "yakun-voucher.jpg", name: "â˜• Ya Kun Voucher / äºšå¤ç¤¼åˆ¸" } // prize round
];

const GRID_SIZE = 6;
const TILE_COUNT = GRID_SIZE * GRID_SIZE;
const TOTAL_PRIZES = 10;

const normalMessage = "Click tiles to reveal the picture";
const prizeMessage =
  "ğŸ <b>Prize Round!</b> Find the prizes!<br>" +
  "ğŸ <b>æŠ½å¥–ç¯èŠ‚ï¼</b> æ‰¾åˆ°å¥–å“!";

let current = 0;
let prizeIndices = [];
const grid = document.getElementById("grid");
const result = document.getElementById("result");
const revealBtn = document.getElementById("revealBtn");
const backBtn = document.getElementById("backBtn");
const nextBtn = document.getElementById("nextBtn");

function loadImage() {
  grid.innerHTML = "";
  prizeIndices = [];

  // Control buttons and messages
  if (current === 0) {
    backBtn.disabled = true;
    backBtn.style.opacity = "0.5";
  } else if (current === pictures.length - 1) {
    // Prize round
    revealBtn.style.display = "none";
    backBtn.disabled = true;
    nextBtn.disabled = true;
    result.innerHTML = prizeMessage;

    // Randomly assign prize tiles
    while (prizeIndices.length < TOTAL_PRIZES) {
      const idx = Math.floor(Math.random() * TILE_COUNT);
      if (!prizeIndices.includes(idx)) prizeIndices.push(idx);
    }
  } else {
    revealBtn.style.display = "inline-block";
    backBtn.disabled = false;
    nextBtn.disabled = false;
    backBtn.style.opacity = "1";
    nextBtn.style.opacity = "1";
    result.textContent = normalMessage;
  }

  const gridSizePx = grid.offsetWidth;
  const tileSize = gridSizePx / GRID_SIZE;

  for (let i = 0; i < TILE_COUNT; i++) {
    const tile = document.createElement("div");
    tile.className = "tile hidden";

    if (current === pictures.length - 1) {
      tile.style.backgroundImage = "none"; // initially hidden for prize round
    } else {
      tile.style.backgroundImage = `url(${pictures[current].src})`;
      const x = (i % GRID_SIZE) * -tileSize;
      const y = Math.floor(i / GRID_SIZE) * -tileSize;
      tile.style.backgroundPosition = `${x}px ${y}px`;
    }

    tile.onclick = () => handleTileClick(tile, i);
    grid.appendChild(tile);
  }
}

function handleTileClick(tile, index) {
  // Prize round
  if (current === pictures.length - 1) {
    if (tile.classList.contains("revealed")) return;
    tile.classList.add("revealed");

    const prizeSrc = pictures[pictures.length - 1].src;

    // ğŸ”‘ Remove red background
    
    tile.style.backgroundSize = "cover";
    tile.style.backgroundPosition = "center";
    tile.style.backgroundRepeat = "no-repeat";

    if (prizeIndices.includes(index)) {
      tile.style.backgroundColor = "transparent";
      tile.style.backgroundImage = `url(${pictures[current].src})`;
      result.innerHTML =
        `ğŸ‰ <b>æ­å–œä½ ï¼You won a prize!</b> ğŸ§§<br>` +
        `è¯·é¢†å–ä½ çš„å¥–å“`;
    } else {
      tile.style.backgroundImage = "none";
      tile.style.backgroundColor = "#ffffff";
      result.innerHTML = `ğŸ˜… ä¸æ˜¯å¥–å“ï¼Œå†è¯•è¯•! / Not a prize, try again!`;
    }
    return;
  }

  // Normal picture behavior
  tile.classList.remove("hidden");
  checkComplete();
}
  
function checkComplete() {
  const hiddenTiles = document.querySelectorAll(".tile.hidden");
  if (hiddenTiles.length === 0) {
    result.textContent = `ğŸ‰ ${pictures[current].name} `;
  }
}

function revealAll() {
  document.querySelectorAll(".tile").forEach(t => t.classList.remove("hidden"));
  if (current === pictures.length - 1) {
    result.innerHTML = prizeMessage;
  } else {
    result.textContent = `ğŸ‰ ${pictures[current].name} `;
  }
}

function nextImage() {
  if (current < pictures.length - 1) {
    current++;
    loadImage();
  }
}

function prevImage() {
  if (current > 0) {
    current--;
    loadImage();
  }
}

window.addEventListener("resize", loadImage);
loadImage();
</script>
</body>
</html>
